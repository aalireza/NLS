# NLS
Natural language Steganography: Encoding ciphertexts in form of natural language text

---


NLS encrypts a message with AES-128, and then transforms the resulting ciphertext to a Natural language text generated by a hidden Markov model. The goal is to encrypt a message without it looking encrypted.


## How it was made?

The code is thoroughly commented which presumably should be descriptive enough. Nonetheless, I'll describe the procedure in words. There are two main components of the program: 1)Encryptor and 2)Text Generator. 

1) <b>The encryptor</b>: Using PyCrypto, messages are encrypted with AES-128, CBC mode. The base of the resulting ciphertext is changed to `x` where 1 < x < 27. Then the digits of this new number would be formatted alphabetically i.e. each 0 would be replaced with `a`, each 1 would be replaced with `b` upto 25. (This way, the hexadecimal value of 10 is no longer "a" but it's "k"). The choice of `x` depends on how many frequent letters of the alphabet one wishes to utilize. E.g. if one wishes to generate sentences that start with 10 letters such that these letters are most probable of all letters to be at the beginning of an English sentence, the the choice for `x` is 10. (By default, we use assume `x` is 10). 

2) <b>The text generator</b>: Using Markovify, we generate texts and filter them by their starting letter such that those letters are in the exact order of the reformatted ciphertext in step (1). 

To decrypt the message, The output of (2) is fed to the inverse of (1).


## Dependencies

+ Python 2.7
+ [PyCrypto] (https://pypi.python.org/pypi/pycrypto)
+ [Markovify] (https://pypi.python.org/pypi/markovify)


## Usage

Have a text file for training purposes ready. Clone the repo and give executable permissions to src/nls i.e. `chmod +x PATH-TO-NLS/src/nls`. The full scheme of the commands are bellow:

1) To enter the interactive mode, do `/PATH-TO-NLS/src/nls -i` There you have the ability to enter the absolute path to your text file and your model (if you've already trained it) etc. If you want to change the word threshold, then add `-w W` at the end of the command where W is a number from 2 to 26. The default W value is 10.

2) To encrypt a file, do `/PATH-TO-NLS/src/nls -e -t MESSAGE -p PASASWORD -m ABSOLUTE-PATH-TO-MODEL -f ABSOLUTE-PATH-TO-TEXT-FILE`. The model is a saved instance of a Markovify text model (saved via cPickle). If a model doesn't exist in the provided path, then a warning message would be shown, asking for a training text in order to train and save th model in that location. Also, ABSOLUTE-PATH-TO-TEXT is the text file which either contains the encoded ciphertext (before decryption) or will be created there to contain the ciphertext (after encryption). You may replace `-e` with `-d` to enter the decryption mode. You may omit `-t` and `-p` in order to enter them in an interactive mode. You also may add `-s` to suppress the output and have the program running in silent mode.
